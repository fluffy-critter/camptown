{%- macro track_title(track) -%}
                    {% if track.artist %}
                    {{ track.artist }}:
                    {% endif %}
                    {% if track.title %}
                    {{ track.title }}
                    {% else %}
                    (Track {{loop.index}})
                    {% endif %}
{%- endmacro -%}

<!DOCTYPE html>
<html>
    <head>
        <title>{{album.artist}}: {{album.title}}</title>
        <link rel="stylesheet" href="player.css">
        <script src="player.js">
        </script>
    </head>
    <body>
        <header>
            <div class="title">
                <h1><a href="{{album.album_url}}" target="_blank" rel="noopener">{{album.title}}</a></h1>
                <h2>by <a href="{{album.artist_url}}" target="_blank" rel="noopener">{{album.artist}}</a></h2>
            </div>
            <div class="player">
                <audio id="player" controls>
                </audio>
                <div id="nowplaying">now playing</div>
            </div>
            {{album.artwork|artwork_img(id="coverart")}}
        </header>
        <ol id="tracklist">
            {% for track in album.tracks %}
            <li class="track{% if track.explicit %} explicit{% endif %}">
                <span class="player"></span>
                <span class="title">
                    {%- if track.filename -%}
                    <a class="name" href="{{track.filename}}">
                        {{ track_title(track) }}
                    </a>
                    {%- else -%}
                    <span class="name">
                        {{ track_title(track) }}
                    </span>
                    {%- endif -%}

                    {% if track.duration %}
                        <time datetime="{{track.duration|datetime}}">{{track.duration|timestamp}}</time>
                    {% endif %}

                    {% if track.artwork %}
                        {{track.artwork|artwork_img}}
                    {% endif %}
                </span>

                {% if track.lyrics %}
                <label class="lyrics" for="lyrics_{{loop.index}}">lyrics</label>
                {% endif %}

                {% if track.about %}
                <label class="about" for="about_{{loop.index}}">info</label>
                {% endif %}

                {% if track.lyrics %}
                <input type="checkbox" id="lyrics_{{loop.index}}">
                <div class="disclosure">{{track.lyrics|lyrics}}</div>
                {% endif %}

                {% if track.about %}
                <input type="checkbox" id="about_{{loop.index}}">
                <div class="disclosure">{{track.about|markdown}}</div>
                {% endif %}
            </li>
            {% endfor %}
        </ol>
    <footer>
        Powered by <a href="https://github.com/fluffy-critter/camptown">Camptown</a>
    </footer>
</body>
</html>